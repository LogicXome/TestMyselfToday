@model TestMyselfToday.Models.Test

@{
    ViewBag.Title = "Test";

    var lstQuestion = Model.Questions.OrderBy(o => o.SortOrder);

    int stepId = 1;

    string step = "ptab";
}


<style type="text/css">
    /***** 6.1 FORM WIZARD STYLES *****/


    .basic-wizard .nav li a {
        background: #e4e7ea;
        border-bottom: 1px solid #ccc;
        color: black;
        border-right: 1px solid #ccc;
        -moz-border-radius: 0;
        -webkit-border-radius: 0;
        border-radius: 0;
        opacity: 0.75;
    }

    .basic-wizard .nav li:last-child a {
        border-right: 0;
    }

    .basic-wizard .nav li a:hover {
        background-color: #f7f7f7;
        opacity: 1;
    }

    .basic-wizard .nav li.active a,
    .basic-wizard .nav li.active a:focus,
    .basic-wizard .nav li.active a:active {
        background: rgba(97, 178, 248, 0.49);
        border-bottom-color: #285E8E;
        color: black;
        opacity: 1;
    }

    .basic-wizard ul li a span {
        font-family: 'LatoBold', sans-serif;
    }

    .basic-wizard .pager {
        margin: 0;
        border-top: 1px solid #ddd;
        background: #f7f7f7;
        padding: 10px;
    }

        .basic-wizard .pager li a {
            -moz-border-radius: 2px;
            -webkit-border-radius: 2px;
            border-radius: 2px;
            border-color: #357EBD;
            background-color: #428BCA;
            color: #fff;
        }

            .basic-wizard .pager li a:hover {
                background-color: #3276B1;
                border-color: #285E8E;
            }

        .basic-wizard .pager li.disabled a {
            background: #eee;
            color: #999;
            border-color: #ccc;
        }

    .basic-wizard .progress {
        height: 12px;
        -moz-border-radius: 2px;
        -webkit-border-radius: 2px;
        border-radius: 2px;
    }

    .basic-wizard .nav-disabled-click li a:hover,
    .basic-wizard .nav-disabled-click li a:active,
    .basic-wizard .nav-disabled-click li a:focus {
        background-color: rgba(46, 155, 89, 0.64);
        color: black;
        cursor: default;
    }

    .basic-wizard .nav-disabled-click li.active a:hover,
    .basic-wizard .nav-disabled-click li.active a:active,
    .basic-wizard .nav-disabled-click li.active a:focus {
        background: rgba(46, 155, 89, 0.64);
        color: black;
        opacity: 1;
    }

    .basic-wizard .tab-content {
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        -moz-border-radius: 0;
        -webkit-border-radius: 0;
        border-radius: 0;
    }

    .question-options {
        padding: 3%;
    }

    .option-text {
        font-weight: bold;
        font-size: large;
    }

    .question-no {
        font-weight: bold;
        font-size: large;
    }

    .tab-pane::after {
        clear: both;
        display: block;
        content: '';
    }

    .testprocess-panel{
        margin-top: 10px;
    }

    .test-title{
        font-family: cursive;
        font-size: large;
    }
    .question-title{
        font-family: cursive;
        font-size: x-large;
        font-weight:bold;
    }
    .question-options{
        font-family: cursive;
        font-size: large;
    }
    .option-selected{
        background-color:aliceblue;
    }
    .radio{
        padding: 5px;
    }
</style>

<div class="col-md-12">
    <div class="panel testprocess-panel">
        <div class="panel-success">
            <div class="panel-body">
                <h3 class="test-title">@Model.Title</h3>

                <div id="progressWizard" class="basic-wizard">

                    <ul class="nav nav-pills nav-justified">
                        @foreach (var question in lstQuestion)
                        {
                            string stepTemp = step + stepId;

                            <li><a href="#@stepTemp" data-toggle="tab"><span class="question-no">Q: @stepId :</span></a></li>
                            stepId++;
                        }
                    </ul>

                    @{
                        stepId = 1;
                    }

                    <form class="tab-content" action="@Url.Action("Test", "Home")" method="post">

                        @foreach (var question in lstQuestion)
                        {
                            string stepTemp = step + stepId;

                            <div class="tab-pane" id="@stepTemp">

                                <h2 class="question-title">@question.Statement</h2>
                                @if (!String.IsNullOrEmpty(question.ImagePath))
                                {                                    
                                    <img src="@question.ImagePath" class="img-responsive" />
                                }

                                @{
                            var lstQuestionOption = question.QuestionOptions.OrderBy(o => o.SortOrder);
                            var counter = 1;
                                }

                                <div class="question-options">
                                    @foreach (var option in lstQuestionOption)
                                    {
                                        <div class="radio">
                                            <input type="radio" class="option-rb" name="o-rb-s-@stepId" id="o-rb-s-@stepId-c-@counter" value="@option.Score">
                                            <span class="option-text">
                                                @option.OptionText
                                            </span>
                                        </div>
                                        counter++;
                                    }
                                </div>
                            </div>
                                    stepId++;
                        }



                        <div class="progress progress-striped active">
                            <div class="progress-bar" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>



                        <ul class="pager wizard">
                            <li class="previous"><a id="previous" href="javascript:void(0)">Previous</a></li>
                            <li class="next"><a id="next" href="javascript:void(0)">Next</a></li>
                            <li class="next finish" style="display:none;"><a href="javascript:;">Finish</a></li>
                        </ul>

                        @{
                            var questionCount = stepId - 1;
                        }

                        <input type="submit" id="btnSubmit" value="Submit" hidden />
                        <input type="hidden" name="QuestionCount" value="@questionCount" />
                        <input type="hidden" name="TestId" value="@Model.Id" />
                    </form>

                </div>
            </div>
        </div>
    </div>
</div>



@section Scripts
{
    <script type="text/javascript" src="~/Scripts/bootstrap.wizard.min.js"></script>

    <script>
        jQuery(document).ready(function () {

            // Progress Wizard
            $('#progressWizard').bootstrapWizard({
                'nextSelector': '.next',
                'previousSelector': '.previous',
                onNext: function (tab, navigation, index) {
                    var $total = navigation.find('li').length;
                    var $current = index + 1;
                    var $percent = ($current / $total) * 100;

                    var selector = 'input[name=o-rb-s-' + index + ']';
                    var selectorChecked = 'input[name=o-rb-s-' + index + ']:checked';

                    if ($(selectorChecked).length > 0 || $(selector).length == 0) {
                        jQuery('#progressWizard').find('.progress-bar').css('width', $percent + '%');
                    }
                    else {
                        alert('Please select one from given options');
                        return false;
                    }

                    if (index == $total) {
                        $('#btnSubmit').trigger('click');
                    }
                },
                onPrevious: function (tab, navigation, index) {
                    if (index > 0) {
                        var $total = navigation.find('li').length;
                        var $current = index + 1;
                        var $percent = ($current / $total) * 100;
                        jQuery('#progressWizard').find('.progress-bar').css('width', $percent + '%');
                    }
                },
                onTabShow: function (tab, navigation, index) {
                    var $total = navigation.find('li').length;
                    var $current = index + 1;
                    var $percent = ($current / $total) * 100;
                    jQuery('#progressWizard').find('.progress-bar').css('width', $percent + '%');

                    if ($current >= $total) {
                        $('#progressWizard').find('.pager .next').hide();
                        $('#progressWizard').find('.pager .finish').show();
                        $('#progressWizard').find('.pager .finish').removeClass('disabled');
                    }
                    else {
                        $('#progressWizard').find('.pager .next').show();
                        $('#progressWizard').find('.pager .finish').hide();
                    }
                },
                tabClass: 'nav nav-pills nav-justified nav-disabled-click',
                onTabClick: function (tab, navigation, index) {
                    return false;
                }
            });

            $('.radio').on('click', function () {
                $(this).find('.option-rb').prop('checked', 'checked');
                $(this).addClass('option-selected');

                $(this).siblings().removeClass('option-selected');
            });
        });
    </script>
}



